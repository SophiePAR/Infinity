<div class="container mt-4 w-50">
<h2 class="text-primary text-center">Choix des prestations</h2>
<br>
<p class="text-para" style="font-size: 18px">Validez chacune des prestations désirées et validez la selection pour terminer.</p>

<br>

<%= simple_form_for [@order, OrderItem.new] do |f| %>
  <%= f.input :prestation_id, as: :select, collection: @prestations = Prestation.all,label: 'Prestation *' %>
  <%= f.input :details, label: 'Détails (donnez nous des précisions)' %>
  <%= f.input :price, label: 'Prix de la prestation' %>

  <%= f.button :submit, "Valider la prestation", class: "text-white btn btn-success btn-lg rounded-4" %>
<% end %>
<br>
  <div class="card-commande text-center">
    <% @order.order_items.each do |order_item| %>
    <li class="list-group-item">
    <ul> <strong><%= order_item.prestation.title %></strong> : <%= order_item.price %> euros </ul>
      <ul><%= order_item.prestation.content %></ul> 
      <ul><% if order_item.details != nil && order_item.details!= ""%> <%='Details de la prestation :'%> <%= order_item.details %>
          <% end %></ul>
      <ul><%= button_to "Retirer la prestation", order_item, class: "btn btn-danger btn-sm rounded", method: :delete %></ul>
      <br>
    </li>
    <% end %>
  </div>
  <div class="card-commande" style="font-size: 26px; font-weight: 700; border-top: 1px solid black;">
    <h6 class="text mt-3">Total de votre commande : </h6>
    <% @sum = 0 %>
    <% @order.order_items.each do |order_item| %>
    <% @price = order_item.price %>
    <% @sum += @price %>
    <% end %>
    <%= @sum %>
    euros
  </div>

  <%= simple_form_for @order do |f| %>
  <%= f.input :progress, value: 'pending', as: :hidden %>

  <div class="col">
    <%= f.input :date, as: :string, label: "Date d'intervention souhaitée *",
                input_html: { data: { controller: "flatpickr" } } %>
  </div>
  <%= f.button :submit, "Valider la selection", class: "btn btn-primary btn-lg rounded-4" %>
  <%= button_to "Annuler", @order, class: "btn btn-danger btn-lg rounded-4", method: :create %>
<% end %>
</div>
